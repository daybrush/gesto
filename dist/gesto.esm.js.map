{"version":3,"file":"gesto.esm.js","sources":["../src/utils.ts","../src/ClientStore.ts","../src/Gesto.ts"],"sourcesContent":["import { Client, Position } from \"./types\";\nimport { IArrayFormat, isNumber } from \"@daybrush/utils\";\n\nexport function getRad(pos1: number[], pos2: number[]) {\n    const distX = pos2[0] - pos1[0];\n    const distY = pos2[1] - pos1[1];\n    const rad = Math.atan2(distY, distX);\n\n    return rad >= 0 ? rad : rad + Math.PI * 2;\n}\n\nexport function getRotatiion(touches: Client[]) {\n    return getRad([\n        touches[0].clientX,\n        touches[0].clientY,\n    ], [\n        touches[1].clientX,\n        touches[1].clientY,\n    ]) / Math.PI * 180;\n}\n\nexport function isMultiTouch(e: any): e is TouchEvent {\n    return e.touches && e.touches.length >= 2;\n}\nexport function getEventClients(e: any): Client[] {\n    if (!e) {\n        return [];\n    } if (e.touches) {\n        return getClients(e.touches);\n    } else {\n        return [getClient(e)];\n    }\n}\nexport function isMouseEvent(e: any): e is MouseEvent {\n    return e && (e.type.indexOf(\"mouse\") > -1 || \"button\" in e);\n}\nexport function getPosition(clients: Client[], prevClients: Client[], startClients: Client[]): Position {\n    const length = startClients.length;\n    const {\n        clientX, clientY,\n        originalClientX, originalClientY,\n    } = getAverageClient(clients, length);\n    const {\n        clientX: prevX,\n        clientY: prevY,\n    } = getAverageClient(prevClients, length);\n\n    const {\n        clientX: startX,\n        clientY: startY,\n    } = getAverageClient(startClients, length);\n    const deltaX = clientX - prevX;\n    const deltaY = clientY - prevY;\n    const distX = clientX - startX;\n    const distY = clientY - startY;\n\n    return {\n        clientX: originalClientX!,\n        clientY: originalClientY!,\n        deltaX,\n        deltaY,\n        distX,\n        distY,\n    };\n}\nexport function getDist(clients: Client[]) {\n    return Math.sqrt(\n        Math.pow(clients[0].clientX - clients[1].clientX, 2)\n        + Math.pow(clients[0].clientY - clients[1].clientY, 2),\n    );\n}\nexport function getClients(touches: IArrayFormat<Touch>) {\n    const length = Math.min(touches.length, 2);\n    const clients = [];\n\n    for (let i = 0; i < length; ++i) {\n        clients.push(getClient(touches[i]));\n    }\n    return clients;\n}\nexport function getClient(e: MouseEvent | Touch): Client {\n    return {\n        clientX: e.clientX,\n        clientY: e.clientY,\n    };\n}\nexport function getAverageClient(clients: Client[], length = clients.length): Required<Client> {\n    const sumClient: Required<Client> = {\n        clientX: 0,\n        clientY: 0,\n        originalClientX: 0,\n        originalClientY: 0,\n    };\n    for (let i = 0; i < length; ++i) {\n        const client = clients[i];\n\n        sumClient.originalClientX += \"originalClientX\" in client ? client.originalClientX! : client.clientX;\n        sumClient.originalClientY += \"originalClientY\" in client ? client.originalClientY! : client.clientY;\n        sumClient.clientX += client.clientX;\n        sumClient.clientY += client.clientY;\n    }\n    if (!length) {\n        return sumClient;\n    }\n    return {\n        clientX: sumClient.clientX / length,\n        clientY: sumClient.clientY / length,\n        originalClientX: sumClient.originalClientX / length,\n        originalClientY: sumClient.originalClientY / length,\n    };\n}\nexport function plueClient(client1: Client, client2: Client) {\n    return {\n        clientX: (client1.clientX + client2.clientX),\n        clientY: (client1.clientY + client2.clientY),\n    };\n}\n\nexport function minusClient(client1: Client, client2: Client) {\n    return {\n        clientX: (client1.clientX - client2.clientX),\n        clientY: (client1.clientY - client2.clientY),\n    };\n}\n","import { Client } from \"./types\";\nimport { getPosition, getDist, getRotatiion, getAverageClient } from \"./utils\";\n\nexport class ClientStore {\n    public prevClients: Client[] = [];\n    public startClients: Client[] = [];\n    public movement = 0;\n    public length  = 0;\n    constructor(clients: Client[]) {\n        this.startClients = clients;\n        this.prevClients = clients;\n        this.length = clients.length;\n    }\n    public getAngle(clients: Client[] = this.prevClients) {\n        return getRotatiion(clients);\n    }\n    public getRotation(clients: Client[] = this.prevClients) {\n        return getRotatiion(clients) - getRotatiion(this.startClients);\n    }\n    public getPosition(clients: Client[] = this.prevClients, isAdd?: boolean) {\n        const position = getPosition(clients || this.prevClients, this.prevClients, this.startClients);\n\n        const { deltaX, deltaY } = position;\n\n        this.movement += Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n        this.prevClients = clients;\n\n        return position;\n    }\n    public getPositions(clients: Client[] = this.prevClients) {\n        const prevClients = this.prevClients;\n\n        return this.startClients.map((startClient, i) => getPosition([clients[i]], [prevClients[i]], [startClient]));\n    }\n    public getMovement(clients?: Client[]) {\n        const movement = this.movement;\n\n        if (!clients) {\n            return movement;\n        }\n        const currentClient = getAverageClient(clients, this.length);\n        const prevClient = getAverageClient(this.prevClients, this.length);\n        const deltaX = currentClient.clientX - prevClient.clientX;\n        const deltaY = currentClient.clientY - prevClient.clientY;\n\n        return Math.sqrt(deltaX * deltaX + deltaY * deltaY) + movement;\n    }\n    public getDistance(clients = this.prevClients) {\n        return getDist(clients);\n    }\n    public getScale(clients = this.prevClients) {\n        return getDist(clients) / getDist(this.startClients);\n    }\n    public move(deltaX: number, deltaY: number) {\n        this.startClients.forEach(client => {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n    }\n}\n","import { Client, OnDrag, GestoOptions, GestoEvents } from \"./types\";\nimport {\n    getEventClients, isMouseEvent, isMultiTouch,\n} from \"./utils\";\nimport EventEmitter, { TargetParam } from \"@scena/event-emitter\";\nimport { addEvent, removeEvent, now, IObject } from \"@daybrush/utils\";\nimport { ClientStore } from \"./ClientStore\";\n\nconst INPUT_TAGNAMES = [\"textarea\", \"input\"];\n/**\n * You can set up drag, pinch events in any browser.\n */\nclass Gesto extends EventEmitter<GestoEvents> {\n    public options: GestoOptions = {};\n    private flag = false;\n    private pinchFlag = false;\n    private data: IObject<any> = {};\n    private isDrag = false;\n    private isPinch = false;\n    private isMouse = false;\n    private isTouch = false;\n    private clientStores: ClientStore[] = [];\n    private targets: Array<Element | Window> = [];\n    private prevTime: number = 0;\n    private doubleFlag: boolean = false;\n    private _dragFlag = false;\n    private _isMouseEvent = false;\n    private _isSecondaryButton = false;\n    private _preventMouseEvent = false;\n\n    /**\n     *\n     */\n    constructor(targets: Array<Element | Window> | Element | Window, options: GestoOptions = {}) {\n        super();\n        const elements = [].concat(targets as any) as Array<Element | Window>;\n        this.options = {\n            checkInput: false,\n            container: elements.length > 1 ? window : elements[0],\n            preventRightClick: true,\n            preventWheelClick: true,\n            preventClickEventOnDragStart: false,\n            preventClickEventOnDrag: false,\n            preventClickEventByCondition: null,\n            preventDefault: true,\n            checkWindowBlur: false,\n            keepDragging: false,\n            pinchThreshold: 0,\n            events: [\"touch\", \"mouse\"],\n            ...options,\n        };\n\n        const { container, events, checkWindowBlur } = this.options;\n\n        this.isTouch = events!.indexOf(\"touch\") > -1;\n        this.isMouse = events!.indexOf(\"mouse\") > -1;\n        this.targets = elements;\n\n        if (this.isMouse) {\n            elements.forEach(el => {\n                addEvent(el, \"mousedown\", this.onDragStart);\n                addEvent(el, \"mousemove\", this._passCallback);\n            });\n            addEvent(container!, \"contextmenu\", this._onContextMenu);\n        }\n        if (checkWindowBlur) {\n            addEvent(window, \"blur\", this.onBlur);\n        }\n        if (this.isTouch) {\n            const passive = {\n                passive: false,\n            };\n            elements.forEach(el => {\n                addEvent(el, \"touchstart\", this.onDragStart, passive);\n                addEvent(el, \"touchmove\", this._passCallback, passive);\n            });\n        }\n    }\n    /**\n     * Stop Gesto's drag events.\n     */\n    public stop() {\n        this.isDrag = false;\n        this.data = {};\n        this.clientStores = [];\n        this.pinchFlag = false;\n        this.doubleFlag = false;\n        this.prevTime = 0;\n        this.flag = false;\n\n        this._allowClickEvent();\n        this._dettachDragEvent();\n    }\n    /**\n     * The total moved distance\n     */\n    public getMovement(clients?: Client[]) {\n        return this.getCurrentStore().getMovement(clients) + this.clientStores.slice(1).reduce((prev, cur) => {\n            return prev + cur.movement;\n        }, 0);\n    }\n    /**\n     * Whether to drag\n     */\n    public isDragging(): boolean {\n        return this.isDrag;\n    }\n    /**\n     * Whether to start drag\n     */\n    public isFlag(): boolean {\n        return this.flag;\n    }\n    /**\n     * Whether to start pinch\n     */\n    public isPinchFlag() {\n        return this.pinchFlag;\n    }\n    /**\n     * Whether to start double click\n     */\n    public isDoubleFlag() {\n        return this.doubleFlag;\n    }\n    /**\n     * Whether to pinch\n     */\n    public isPinching() {\n        return this.isPinch;\n    }\n\n    /**\n     * If a scroll event occurs, it is corrected by the scroll distance.\n     */\n    public scrollBy(deltaX: number, deltaY: number, e: any, isCallDrag: boolean = true) {\n        if (!this.flag) {\n            return;\n        }\n        this.clientStores[0].move(deltaX, deltaY);\n        isCallDrag && this.onDrag(e, true);\n    }\n    /**\n     * Create a virtual drag event.\n     */\n    public move([deltaX, deltaY]: number[], inputEvent: any): TargetParam<OnDrag> {\n        const store = this.getCurrentStore();\n        const nextClients = store.prevClients;\n\n        return this.moveClients(nextClients.map(({ clientX, clientY }) => {\n            return {\n                clientX: clientX + deltaX,\n                clientY: clientY + deltaY,\n                originalClientX: clientX,\n                originalClientY: clientY,\n            };\n        }), inputEvent, true);\n    }\n    /**\n     * The dragStart event is triggered by an external event.\n     */\n    public triggerDragStart(e: any) {\n        this.onDragStart(e, false);\n    }\n    /**\n     * Set the event data while dragging.\n     */\n    public setEventData(data: IObject<any>) {\n        const currentData = this.data;\n\n        for (const name in data) {\n            currentData[name] = data[name];\n        }\n        return this;\n    }\n    /**\n     * Set the event data while dragging.\n     * Use `setEventData`\n     * @deprecated\n     */\n    public setEventDatas(data: IObject<any>) {\n        return this.setEventData(data);\n    }\n    /**\n     * Get the current event state while dragging.\n     */\n    public getCurrentEvent(inputEvent?: any) {\n        return {\n            data: this.data,\n            datas: this.data,\n            ...this._getPosition(),\n            movement: this.getMovement(),\n            isDrag: this.isDrag,\n            isPinch: this.isPinch,\n            isScroll: false,\n            inputEvent,\n        };\n    }\n    /**\n     * Get & Set the event data while dragging.\n     */\n    public getEventData() {\n        return this.data;\n    }\n    /**\n     * Get & Set the event data while dragging.\n     * Use getEventData method\n     * @depreacated\n     */\n    public getEventDatas() {\n        return this.data;\n    }\n    /**\n     * Unset Gesto\n     */\n    public unset() {\n        const targets = this.targets;\n        const container = this.options.container!;\n\n        this.off();\n        removeEvent(window, \"blur\", this.onBlur);\n        if (this.isMouse) {\n            targets.forEach(target => {\n                removeEvent(target, \"mousedown\", this.onDragStart);\n            });\n            removeEvent(container, \"contextmenu\", this._onContextMenu);\n        }\n        if (this.isTouch) {\n            targets.forEach(target => {\n                removeEvent(target, \"touchstart\", this.onDragStart);\n            });\n            removeEvent(container, \"touchstart\", this.onDragStart);\n        }\n        this._allowClickEvent();\n        this._dettachDragEvent();\n    }\n    public onDragStart = (e: any, isTrusted = true) => {\n        if (!this.flag && e.cancelable === false) {\n            return;\n        }\n        const {\n            container,\n            pinchOutside,\n            preventWheelClick,\n            preventRightClick,\n            preventDefault,\n            checkInput,\n            preventClickEventOnDragStart,\n            preventClickEventOnDrag,\n            preventClickEventByCondition,\n        } = this.options;\n        const isTouch = this.isTouch;\n        const isDragStart = !this.flag;\n\n        this._isSecondaryButton = e.which === 3 || e.button === 2;\n\n        if (\n            (preventWheelClick && (e.which === 2 || e.button === 1))\n            || (preventRightClick && (e.which === 3 || e.button === 2))\n        ) {\n            this.stop();\n            return false;\n        }\n\n        if (isDragStart) {\n            const activeElement = document.activeElement as HTMLElement;\n            const target = e.target as HTMLElement;\n\n           if (target) {\n                const tagName = target.tagName.toLowerCase();\n                const hasInput = INPUT_TAGNAMES.indexOf(tagName) > -1;\n                const hasContentEditable = target.isContentEditable;\n\n                if (hasInput || hasContentEditable) {\n                    if (checkInput || activeElement === target) {\n                        // force false or already focused.\n                        return false;\n                    }\n                    // no focus\n                    if (\n                        activeElement\n                        && hasContentEditable\n                        && activeElement.isContentEditable\n                        && activeElement.contains(target)\n                    ) {\n                        return false;\n                    }\n                } else if ((preventDefault || e.type === \"touchstart\") && activeElement) {\n                    const activeTagName = activeElement.tagName.toLowerCase();\n\n                    if (activeElement.isContentEditable || INPUT_TAGNAMES.indexOf(activeTagName) > -1) {\n                        activeElement.blur();\n                    }\n                }\n\n                if (preventClickEventOnDragStart || preventClickEventOnDrag || preventClickEventByCondition) {\n                    addEvent(window, \"click\", this._onClick, true);\n                }\n            }\n            this.clientStores = [new ClientStore(getEventClients(e))];\n            this.flag = true;\n            this.isDrag = false;\n            this._dragFlag = true;\n            this.data = {};\n\n            this.doubleFlag = now() - this.prevTime < 200;\n            this._isMouseEvent = isMouseEvent(e);\n            if (!this._isMouseEvent && this._preventMouseEvent) {\n                this._preventMouseEvent = false;\n            }\n\n            const result = this._preventMouseEvent || this.emit(\"dragStart\", {\n                data: this.data,\n                datas: this.data,\n                inputEvent: e,\n                isMouseEvent: this._isMouseEvent,\n                isSecondaryButton: this._isSecondaryButton,\n                isTrusted,\n                isDouble: this.doubleFlag,\n                ...this.getCurrentStore().getPosition(),\n                preventDefault() {\n                    e.preventDefault();\n                },\n                preventDrag: () => {\n                    this._dragFlag = false;\n                },\n            });\n            if (result === false) {\n                this.stop();\n            }\n            if (this._isMouseEvent && this.flag && preventDefault) {\n                e.preventDefault();\n            }\n        }\n        if (!this.flag) {\n            return false;\n        }\n        let timer = 0;\n\n        if (isDragStart) {\n            this._attchDragEvent();\n\n            // wait pinch\n            if (isTouch && pinchOutside) {\n                timer = setTimeout(() => {\n                    addEvent(container!, \"touchstart\", this.onDragStart, {\n                        passive: false\n                    });\n                });\n            }\n        } else if (isTouch && pinchOutside) {\n            // pinch is occured\n            removeEvent(container!, \"touchstart\", this.onDragStart);\n        }\n        if (this.flag && isMultiTouch(e)) {\n            clearTimeout(timer);\n            if (isDragStart && (e.touches.length !== e.changedTouches.length)) {\n                return;\n            }\n            if (!this.pinchFlag) {\n                this.onPinchStart(e);\n            }\n        }\n\n    }\n    public onDrag = (e: any, isScroll?: boolean) => {\n        if (!this.flag) {\n            return;\n        }\n        const {\n            preventDefault,\n        } = this.options;\n        if (!this._isMouseEvent && preventDefault) {\n            e.preventDefault();\n        }\n        const clients = getEventClients(e);\n        const result = this.moveClients(clients, e, false);\n\n        if (this._dragFlag) {\n            if (this.pinchFlag || result.deltaX || result.deltaY) {\n                const dragResult = this._preventMouseEvent || this.emit(\"drag\", {\n                    ...result,\n                    isScroll: !!isScroll,\n                    inputEvent: e,\n                });\n\n                if (dragResult === false) {\n                    this.stop();\n                    return;\n                }\n            }\n            if (this.pinchFlag) {\n                this.onPinch(e, clients);\n            }\n        }\n\n        this.getCurrentStore().getPosition(clients, true);\n    }\n    public onDragEnd = (e?: any) => {\n        if (!this.flag) {\n            return;\n        }\n        const {\n            pinchOutside,\n            container,\n            preventClickEventOnDrag,\n            preventClickEventOnDragStart,\n            preventClickEventByCondition,\n        } = this.options;\n        const isDrag = this.isDrag;\n\n        if (preventClickEventOnDrag || preventClickEventOnDragStart || preventClickEventByCondition) {\n            requestAnimationFrame(() => {\n                this._allowClickEvent();\n            });\n        }\n        if (!preventClickEventByCondition && !preventClickEventOnDragStart && preventClickEventOnDrag && !isDrag) {\n            this._allowClickEvent();\n        }\n\n        if (this.isTouch && pinchOutside) {\n            removeEvent(container!, \"touchstart\", this.onDragStart);\n        }\n        if (this.pinchFlag) {\n            this.onPinchEnd(e);\n        }\n        const clients = e?.touches ? getEventClients(e) : [];\n        const clientsLength = clients.length;\n\n        if (clientsLength === 0 || !this.options.keepDragging) {\n            this.flag = false;\n        } else {\n            this._addStore(new ClientStore(clients));\n        }\n\n\n        const position = this._getPosition();\n        const currentTime = now();\n        const isDouble = !isDrag && this.doubleFlag;\n\n        this.prevTime = isDrag || isDouble ? 0 : currentTime;\n\n        if (!this.flag) {\n            this._dettachDragEvent();\n\n            this._preventMouseEvent || this.emit(\"dragEnd\", {\n                data: this.data,\n                datas: this.data,\n                isDouble,\n                isDrag: isDrag,\n                isClick: !isDrag,\n                isMouseEvent: this._isMouseEvent,\n                isSecondaryButton: this._isSecondaryButton,\n                inputEvent: e,\n                ...position,\n            });\n\n            this.clientStores = [];\n\n            if (!this._isMouseEvent) {\n                this._preventMouseEvent = true;\n                requestAnimationFrame(() => {\n                    requestAnimationFrame(() => {\n                        this._preventMouseEvent = false;\n                    });\n                });\n            }\n        }\n    }\n    public onPinchStart(e: TouchEvent) {\n        const { pinchThreshold } = this.options;\n\n        if (this.isDrag && this.getMovement() > pinchThreshold!) {\n            return;\n        }\n        const store = new ClientStore(getEventClients(e));\n\n        this.pinchFlag = true;\n        this._addStore(store);\n\n        const result = this.emit(\"pinchStart\", {\n            data: this.data,\n            datas: this.data,\n            angle: store.getAngle(),\n            touches: this.getCurrentStore().getPositions(),\n            ...store.getPosition(),\n            inputEvent: e,\n        });\n\n        if (result === false) {\n            this.pinchFlag = false;\n        }\n    }\n    public onPinch(e: TouchEvent, clients: Client[]) {\n        if (!this.flag || !this.pinchFlag || clients.length < 2) {\n            return;\n        }\n\n        const store = this.getCurrentStore();\n        this.isPinch = true;\n\n        this.emit(\"pinch\", {\n            data: this.data,\n            datas: this.data,\n            movement: this.getMovement(clients),\n            angle: store.getAngle(clients),\n            rotation: store.getRotation(clients),\n            touches: store.getPositions(clients),\n            scale: store.getScale(clients),\n            distance: store.getDistance(clients),\n            ...store.getPosition(clients),\n            inputEvent: e,\n        });\n    }\n    public onPinchEnd(e: TouchEvent) {\n        if (!this.pinchFlag) {\n            return;\n        }\n        const isPinch = this.isPinch;\n\n        this.isPinch = false;\n        this.pinchFlag = false;\n        const store = this.getCurrentStore();\n        this.emit(\"pinchEnd\", {\n            data: this.data,\n            datas: this.data,\n            isPinch,\n            touches: store.getPositions(),\n            ...store.getPosition(),\n            inputEvent: e,\n        });\n    }\n    private getCurrentStore() {\n        return this.clientStores[0];\n    }\n    private moveClients(clients: Client[], inputEvent: any, isAdd: boolean): TargetParam<OnDrag> {\n        const position = this._getPosition(clients, isAdd);\n\n        if (position.deltaX || position.deltaY) {\n            this.isDrag = true;\n        }\n\n        return {\n            data: this.data,\n            datas: this.data,\n            ...position,\n            movement: this.getMovement(clients),\n            isDrag: this.isDrag,\n            isPinch: this.isPinch,\n            isScroll: false,\n            isMouseEvent: this._isMouseEvent,\n            isSecondaryButton: this._isSecondaryButton,\n            inputEvent,\n        };\n    }\n    private onBlur = () => {\n        this.onDragEnd();\n    }\n    private _addStore(store: ClientStore) {\n        this.clientStores.splice(0, 0, store);\n    }\n    private _getPosition(clients?: Client[], isAdd?: boolean) {\n        const store = this.getCurrentStore();\n        const position = store.getPosition(clients, isAdd);\n\n        const { distX, distY } = this.clientStores.slice(1).reduce((prev, cur) => {\n            const storePosition = cur.getPosition();\n\n            prev.distX += storePosition.distX;\n            prev.distY += storePosition.distY;\n            return prev;\n        }, position);\n\n        return {\n            ...position,\n            distX,\n            distY,\n        };\n    }\n    private _allowClickEvent = () => {\n        removeEvent(window, \"click\", this._onClick, true);\n    };\n    private _attchDragEvent() {\n        const container = this.options.container!;\n        const passive = {\n            passive: false\n        };\n\n        if (this.isMouse) {\n            addEvent(container, \"mousemove\", this.onDrag);\n            addEvent(container, \"mouseup\", this.onDragEnd);\n        }\n\n        if (this.isTouch) {\n            addEvent(container, \"touchmove\", this.onDrag, passive);\n            addEvent(container, \"touchend\", this.onDragEnd, passive);\n            addEvent(container, \"touchcancel\", this.onDragEnd, passive);\n        }\n    };\n    private _dettachDragEvent() {\n        const container = this.options.container!;\n\n        if (this.isMouse) {\n            removeEvent(container, \"mousemove\", this.onDrag);\n            removeEvent(container, \"mouseup\", this.onDragEnd);\n        }\n\n        if (this.isTouch) {\n            removeEvent(container, \"touchstart\", this.onDragStart);\n            removeEvent(container, \"touchmove\", this.onDrag);\n            removeEvent(container, \"touchend\", this.onDragEnd);\n            removeEvent(container, \"touchcancel\", this.onDragEnd);\n        }\n    };\n    private _onClick = (e: MouseEvent) => {\n        this._allowClickEvent();\n        this._preventMouseEvent = false;\n        const preventClickEventByCondition = this.options.preventClickEventByCondition;\n        if (preventClickEventByCondition?.(e)) {\n            return;\n        }\n        e.stopPropagation();\n        e.preventDefault();\n    }\n    private _onContextMenu = (e: MouseEvent) => {\n        const options = this.options;\n        if (!options.preventRightClick) {\n            e.preventDefault();\n        } else {\n            this.onDragEnd(e);\n        }\n    }\n    private _passCallback = () => {};\n}\n\nexport default Gesto;\n"],"names":["getRad","pos1","pos2","distX","distY","rad","Math","atan2","PI","getRotatiion","touches","clientX","clientY","isMultiTouch","e","length","getEventClients","getClients","getClient","isMouseEvent","type","indexOf","getPosition","clients","prevClients","startClients","_a","getAverageClient","originalClientX","originalClientY","_b","prevX","prevY","_c","startX","startY","deltaX","deltaY","getDist","sqrt","pow","min","i","push","sumClient","client","isAdd","position","movement","map","startClient","currentClient","prevClient","forEach","INPUT_TAGNAMES","__extends","targets","options","_super","_this","isTrusted","flag","cancelable","container","pinchOutside","preventWheelClick","preventRightClick","preventDefault","checkInput","preventClickEventOnDragStart","preventClickEventOnDrag","preventClickEventByCondition","isTouch","isDragStart","_isSecondaryButton","which","button","stop","activeElement","document","target","tagName","toLowerCase","hasInput","hasContentEditable","isContentEditable","contains","activeTagName","blur","addEvent","window","_onClick","clientStores","ClientStore","isDrag","_dragFlag","data","doubleFlag","now","prevTime","_isMouseEvent","_preventMouseEvent","result","emit","datas","inputEvent","isSecondaryButton","isDouble","getCurrentStore","preventDrag","timer","_attchDragEvent","setTimeout","onDragStart","passive","removeEvent","clearTimeout","changedTouches","pinchFlag","onPinchStart","isScroll","moveClients","dragResult","onPinch","requestAnimationFrame","_allowClickEvent","onPinchEnd","clientsLength","keepDragging","_addStore","_getPosition","currentTime","_dettachDragEvent","isClick","onDragEnd","stopPropagation","elements","concat","checkWindowBlur","pinchThreshold","events","isMouse","el","_passCallback","_onContextMenu","onBlur","passive_1","getMovement","slice","reduce","prev","cur","isPinch","isCallDrag","move","onDrag","store","nextClients","currentData","name","setEventData","off","angle","getAngle","getPositions","rotation","getRotation","scale","getScale","distance","getDistance","splice","storePosition","EventEmitter"],"mappings":"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"}