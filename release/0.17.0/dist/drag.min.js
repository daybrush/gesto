/*
Copyright (c) 2019 Daybrush
name: @daybrush/drag
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/drag.git
version: 0.17.0
*/
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).Dragger=i()}(this,function(){"use strict";var u=function(){return(u=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)};function l(t){return function(t,i){var n=i[0]-t[0],s=i[1]-t[1],e=Math.atan2(s,n);return 0<=e?e:e+2*Math.PI}([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function f(t,i,n,s){var e=m(t),a=m(i),r=m(s);return p(h(s[0],o(e,r)),h(s[0],o(a,r)),n[0])}function g(t){return t.touches?D(t.touches):[e(t)]}function p(t,i,n){var s=t.clientX,e=t.clientY;return{clientX:s,clientY:e,deltaX:s-i.clientX,deltaY:e-i.clientY,distX:s-n.clientX,distY:e-n.clientY}}function v(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function d(t,n,s){return t.map(function(t,i){return p(t,n[i],s[i])})}function D(t){for(var i=Math.min(t.length,2),n=[],s=0;s<i;++s)n.push(e(t[s]));return n}function e(t){return{clientX:t.clientX,clientY:t.clientY}}function m(t){return 1===t.length?t[0]:{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function h(t,i){return{clientX:t.clientX+i.clientX,clientY:t.clientY+i.clientY}}function o(t,i){return{clientX:t.clientX-i.clientX,clientY:t.clientY-i.clientY}}function C(){return Date.now?Date.now():(new Date).getTime()}function X(t,i,n,s){t.addEventListener(i,n,s)}function Y(t,i,n){t.removeEventListener(i,n)}var n=function(){function t(t,i){var l=this;void 0===i&&(i={}),this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.targets=[],this.prevTime=0,this.isDouble=!1,this.startRotate=0,this.onDragStart=function(t){if(l.flag||!1!==t.cancelable){var i=l.options,n=i.container,s=i.pinchOutside,e=i.dragstart,a=i.preventRightClick,r=i.preventDefault,h=l.isTouch;if(!l.flag&&h&&s&&setTimeout(function(){X(n,"touchstart",l.onDragStart)}),l.flag&&h&&s&&Y(n,"touchstart",l.onDragStart),function(t){return t.touches&&2<=t.touches.length}(t)){if(!l.flag&&t.touches.length!==t.changedTouches.length)return;l.pinchFlag||l.onPinchStart(t)}if(!l.flag){var o=l.startClients[0]?l.startClients:g(t);l.customDist=[0,0],l.flag=!0,l.isDrag=!1,l.startClients=o,l.prevClients=o,l.datas={};var c=p(o[l.movement=0],l.prevClients[0],l.startClients[0]);(!a||3!==t.which&&2!==t.button)&&!1!==(e&&e(u({type:"dragstart",datas:l.datas,inputEvent:t},c)))||(l.startClients=[],l.prevClients=[],l.flag=!1),l.isDouble=C()-l.prevTime<200,l.flag&&r&&t.preventDefault()}}},this.onDrag=function(t,i){if(l.flag){var n=g(t);l.pinchFlag&&l.onPinch(t,n);var s=l.move([0,0],t,n);if(s&&(s.deltaX||s.deltaY)){var e=l.options.drag;e&&e(u({},s,{isScroll:!!i,inputEvent:t}))}}},this.onDragEnd=function(t){if(l.flag){var i=l.options,n=i.dragend,s=i.pinchOutside,e=i.container;l.isTouch&&s&&Y(e,"touchstart",l.onDragStart),l.pinchFlag&&l.onPinchEnd(t),l.flag=!1;var a=l.prevClients,r=l.startClients,h=l.pinchFlag?f(a,a,r,l.startPinchClients):p(a[0],a[0],r[0]),o=C(),c=!l.isDrag&&l.isDouble;l.prevTime=l.isDrag||c?0:o,l.startClients=[],l.prevClients=[],n&&n(u({type:"dragend",datas:l.datas,isDouble:c,isDrag:l.isDrag,inputEvent:t},h))}};var n=[].concat(t);this.options=u({container:1<n.length?window:n[0],preventRightClick:!0,preventDefault:!0,pinchThreshold:0,events:["touch","mouse"]},i);var s=this.options,e=s.container,a=s.events;if(this.isTouch=-1<a.indexOf("touch"),this.isMouse=-1<a.indexOf("mouse"),this.customDist=[0,0],this.targets=n,this.isMouse&&(n.forEach(function(t){X(t,"mousedown",l.onDragStart)}),X(e,"mousemove",this.onDrag),X(e,"mouseup",this.onDragEnd),X(e,"contextmenu",this.onDragEnd)),this.isTouch){var r={passive:!1};n.forEach(function(t){X(t,"touchstart",l.onDragStart,r)}),X(e,"touchmove",this.onDrag,r),X(e,"touchend",this.onDragEnd,r),X(e,"touchcancel",this.onDragEnd,r)}}var i=t.prototype;return i.isDragging=function(){return this.isDrag},i.isFlag=function(){return this.flag},i.isPinchFlag=function(){return this.pinchFlag},i.isPinching=function(){return this.isPinch},i.scrollBy=function(i,n,t,s){void 0===s&&(s=!0),this.flag&&(this.startClients.forEach(function(t){t.clientX-=i,t.clientY-=n}),this.prevClients.forEach(function(t){t.clientX-=i,t.clientY-=n}),s&&this.onDrag(t,!0))},i.move=function(t,i,n){var s=t[0],e=t[1];void 0===n&&(n=this.prevClients);var a=this.customDist,r=this.prevClients,h=this.startClients,o=this.pinchFlag?f(n,r,h,this.startPinchClients):p(n[0],r[0],h[0]);a[0]+=s,a[1]+=e,o.deltaX+=s,o.deltaY+=e;var c=o.deltaX,l=o.deltaY;return o.distX+=a[0],o.distY+=a[1],this.movement+=Math.sqrt(c*c+l*l),this.prevClients=n,this.isDrag=!0,u({type:"drag",datas:this.datas},o,{movement:this.movement,isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:i})},i.onPinchStart=function(t){var i,n,s=this.options,e=s.pinchstart,a=s.pinchThreshold;if(!(this.isDrag&&this.movement>a)){var r=D(t.changedTouches);if(this.pinchFlag=!0,(i=this.startClients).push.apply(i,r),(n=this.prevClients).push.apply(n,r),this.startDistance=v(this.prevClients),this.startPinchClients=this.prevClients.slice(),e){var h=this.prevClients,o=m(h),c=p(o,o,o);this.startRotate=l(h),e(u({type:"pinchstart",datas:this.datas,angle:this.startRotate,touches:d(h,h,h)},c,{inputEvent:t}))}}},i.onPinch=function(t,i){if(this.flag&&this.pinchFlag&&!(i.length<2)){this.isPinch=!0;var n=this.options.pinch;if(n){var s=this.prevClients,e=this.startClients,a=p(m(i),m(s),m(e)),r=l(i),h=v(i);n(u({type:"pinch",datas:this.datas,movement:this.movement,angle:r,rotation:r-this.startRotate,touches:d(i,s,e),scale:h/this.startDistance,distance:h},a,{inputEvent:t}))}}},i.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var i=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.options.pinchend;if(n){var s=this.prevClients,e=this.startClients,a=p(m(s),m(s),m(e));n(u({type:"pinchend",datas:this.datas,isPinch:i,touches:d(s,s,e)},a,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},i.unset=function(){var i=this,t=this.targets,n=this.options.container;this.isMouse&&(t.forEach(function(t){Y(t,"mousedown",i.onDragStart)}),Y(n,"mousemove",this.onDrag),Y(n,"mouseup",this.onDragEnd),Y(n,"contextmenu",this.onDragEnd)),this.isTouch&&(t.forEach(function(t){Y(t,"touchstart",i.onDragStart)}),Y(n,"touchstart",this.onDragStart),Y(n,"touchmove",this.onDrag),Y(n,"touchend",this.onDragEnd),Y(n,"touchcancel",this.onDragEnd))},t}();var t={default:n,drag:function(t,i){return new n(t,i)}};for(var i in t)n[i]=t[i];return n});
//# sourceMappingURL=drag.min.js.map
