{"version":3,"file":"drag.js","sources":["../src/utils.ts","../src/Dragger.ts","../src/drag.ts","../src/index.umd.ts"],"sourcesContent":["import { Client, Position } from \"./types\";\nimport { IArrayFormat } from \"@daybrush/utils\";\n\nexport function getRad(pos1: number[], pos2: number[]) {\n    const distX = pos2[0] - pos1[0];\n    const distY = pos2[1] - pos1[1];\n    const rad = Math.atan2(distY, distX);\n\n    return rad >= 0 ? rad : rad + Math.PI * 2;\n}\n\nexport function getRotatiion(touches: Client[]) {\n    return getRad([\n        touches[0].clientX,\n        touches[0].clientY,\n    ], [\n        touches[1].clientX,\n        touches[1].clientY,\n    ]) / Math.PI * 180;\n}\n\nexport function getPinchDragPosition(\n    clients: Client[],\n    prevClients: Client[],\n    startClients: Client[],\n    startPinchClients: Client[],\n) {\n    const nowCenter = getAverageClient(clients);\n    const prevCenter = getAverageClient(prevClients);\n    const startCenter = getAverageClient(startPinchClients);\n    const pinchClient = plueClient(startPinchClients[0], minusClient(nowCenter, startCenter));\n    const pinchPrevClient = plueClient(startPinchClients[0], minusClient(prevCenter, startCenter));\n\n    return getPosition(pinchClient, pinchPrevClient, startClients[0]);\n}\nexport function isMultiTouch(e: any): e is TouchEvent {\n    return e.touches && e.touches.length >= 2;\n}\nexport function getPositionEvent(e: any): Client[] {\n    if (e.touches) {\n        return getClients(e.touches);\n    } else {\n        return [getClient(e)];\n    }\n}\nexport function getPosition(client: Client, prevClient: Client, startClient: Client): Position {\n    const { clientX, clientY } = client;\n    const {\n        clientX: prevX,\n        clientY: prevY,\n    } = prevClient;\n\n    const {\n        clientX: startX,\n        clientY: startY,\n    } = startClient;\n    const deltaX = clientX - prevX;\n    const deltaY = clientY - prevY;\n    const distX = clientX - startX;\n    const distY = clientY - startY;\n\n    return {\n        clientX,\n        clientY,\n        deltaX,\n        deltaY,\n        distX,\n        distY,\n    };\n}\nexport function getDist(clients: Client[]) {\n    return Math.sqrt(\n        Math.pow(clients[0].clientX - clients[1].clientX, 2)\n        + Math.pow(clients[0].clientY - clients[1].clientY, 2),\n    );\n}\nexport function getPositions(clients: Client[], prevClients: Client[], startClients: Client[]): Position[] {\n    return clients.map((client, i) => getPosition(client, prevClients[i], startClients[i]));\n}\nexport function getClients(touches: IArrayFormat<Touch>) {\n    const length = Math.min(touches.length, 2);\n    const clients = [];\n\n    for (let i = 0; i < length; ++i) {\n        clients.push(getClient(touches[i]));\n    }\n    return clients;\n}\nexport function getClient(e: MouseEvent | Touch): Client {\n    return {\n        clientX: e.clientX,\n        clientY: e.clientY,\n    };\n}\nexport function getAverageClient(clients: Client[]) {\n    if (clients.length === 1) {\n        return clients[0];\n    }\n    return {\n        clientX: (clients[0].clientX + clients[1].clientX) / 2,\n        clientY: (clients[0].clientY + clients[1].clientY) / 2,\n    };\n}\nexport function plueClient(client1: Client, client2: Client) {\n    return {\n        clientX: (client1.clientX + client2.clientX),\n        clientY: (client1.clientY + client2.clientY),\n    };\n}\n\nexport function minusClient(client1: Client, client2: Client) {\n    return {\n        clientX: (client1.clientX - client2.clientX),\n        clientY: (client1.clientY - client2.clientY),\n    };\n}\n","import { DragOptions, Client, Position, OnDrag } from \"./types\";\nimport {\n    getPositionEvent, getPosition, getClients, getPositions,\n    isMultiTouch, getPinchDragPosition, getAverageClient, getDist, getRotatiion,\n} from \"./utils\";\nimport { addEvent, removeEvent, now } from \"@daybrush/utils\";\n\nconst INPUT_TAGNAMES = [\"textarea\", \"input\"];\n/**\n * You can set up drag events in any browser.\n */\nclass Dragger {\n    public options: DragOptions = {};\n    private flag = false;\n    private pinchFlag = false;\n    private datas = {};\n    private isDrag = false;\n    private isPinch = false;\n    private isMouse = false;\n    private isTouch = false;\n    private prevClients: Client[] = [];\n    private startClients: Client[] = [];\n    private movement: number = 0;\n    private startPinchClients: Client[] = [];\n    private startDistance: number = 0;\n    private customDist = [0, 0];\n    private targets: Array<Element | Window> = [];\n    private prevTime: number = 0;\n    private isDouble: boolean = false;\n    private startRotate = 0;\n    /**\n     *\n     */\n    constructor(targets: Array<Element | Window> | Element | Window, options: DragOptions = {}) {\n        const elements = [].concat(targets as any) as Array<Element | Window>;\n        this.options = {\n            checkInput: false,\n            container: elements.length > 1 ? window : elements[0],\n            preventRightClick: true,\n            preventDefault: true,\n            pinchThreshold: 0,\n            events: [\"touch\", \"mouse\"],\n            ...options,\n        };\n\n        const { container, events } = this.options;\n\n        this.isTouch = events!.indexOf(\"touch\") > -1;\n        this.isMouse = events!.indexOf(\"mouse\") > -1;\n        this.customDist = [0, 0];\n        this.targets = elements;\n\n        if (this.isMouse) {\n            elements.forEach(el => {\n                addEvent(el, \"mousedown\", this.onDragStart);\n            });\n            addEvent(container!, \"mousemove\", this.onDrag);\n            addEvent(container!, \"mouseup\", this.onDragEnd);\n            addEvent(container!, \"contextmenu\", this.onDragEnd);\n        }\n        if (this.isTouch) {\n            const passive = {\n                passive: false,\n            };\n            elements.forEach(el => {\n                addEvent(el, \"touchstart\", this.onDragStart, passive);\n            });\n            addEvent(container!, \"touchmove\", this.onDrag, passive);\n            addEvent(container!, \"touchend\", this.onDragEnd, passive);\n            addEvent(container!, \"touchcancel\", this.onDragEnd, passive);\n        }\n    }\n    /**\n     *\n     */\n    public isDragging() {\n        return this.isDrag;\n    }\n    /**\n     *\n     */\n    public isFlag() {\n        return this.flag;\n    }\n    /**\n     *\n     */\n    public isPinchFlag() {\n        return this.pinchFlag;\n    }\n    /**\n     *\n     */\n    public isPinching() {\n        return this.isPinch;\n    }\n    /**\n     *\n     */\n    public scrollBy(deltaX: number, deltaY: number, e: any, isCallDrag: boolean = true) {\n        if (!this.flag) {\n            return;\n        }\n        this.startClients.forEach(client => {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n        this.prevClients.forEach(client => {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n        isCallDrag && this.onDrag(e, true);\n    }\n    /**\n     * @method\n     */\n    public onDragStart = (e: any, isTrusted = true) => {\n        if (!this.flag && e.cancelable === false) {\n            return;\n        }\n        const { container, pinchOutside, dragstart, preventRightClick, preventDefault, checkInput } = this.options;\n        const isTouch = this.isTouch;\n\n        if (!this.flag) {\n            const activeElement = document.activeElement as HTMLElement;\n            const target = e.target as HTMLElement;\n            const tagName = target.tagName.toLowerCase();\n            const hasInput = INPUT_TAGNAMES.indexOf(tagName) > -1;\n            const hasContentEditable = target.isContentEditable;\n\n            if (hasInput || hasContentEditable) {\n                if (checkInput || activeElement === target) {\n                    // force false or already focused.\n                    return false;\n                }\n                if (\n                    activeElement\n                    && hasContentEditable\n                    && activeElement.isContentEditable\n                    && activeElement.contains(target)\n                ) {\n                    return false;\n                }\n            } else if ((preventDefault || e.type === \"touchstart\") && activeElement) {\n                const activeTagName = activeElement.tagName;\n                if (activeElement.isContentEditable || INPUT_TAGNAMES.indexOf(activeTagName) > -1) {\n                    activeElement.blur();\n                }\n            }\n        }\n        let timer = 0;\n\n        if (!this.flag && isTouch && pinchOutside) {\n            timer = setTimeout(() => {\n                addEvent(container!, \"touchstart\", this.onDragStart, { passive: false });\n            });\n        }\n        if (this.flag && isTouch && pinchOutside) {\n            removeEvent(container!, \"touchstart\", this.onDragStart);\n        }\n        if (isMultiTouch(e)) {\n            clearTimeout(timer);\n            if (!this.flag && (e.touches.length !== e.changedTouches.length)) {\n                return;\n            }\n            if (!this.pinchFlag) {\n                this.onPinchStart(e);\n            }\n        }\n        if (this.flag) {\n            return;\n        }\n        const clients = this.startClients[0] ? this.startClients : getPositionEvent(e);\n\n        this.customDist = [0, 0];\n        this.flag = true;\n        this.isDrag = false;\n        this.startClients = clients;\n        this.prevClients = clients;\n        this.datas = {};\n        this.movement = 0;\n\n        const position = getPosition(clients[0], this.prevClients[0], this.startClients[0]);\n\n        if (preventRightClick && (e.which === 3 || e.button === 2)) {\n            clearTimeout(timer);\n            this.initDrag();\n            return false;\n        }\n        const result = dragstart && dragstart({\n            type: \"dragstart\",\n            datas: this.datas,\n            inputEvent: e,\n            isTrusted,\n            ...position,\n        });\n        if (result === false) {\n            clearTimeout(timer);\n            this.initDrag();\n        }\n        this.isDouble = now() - this.prevTime < 200;\n        this.flag && preventDefault && e.preventDefault();\n    }\n    public onDrag = (e: any, isScroll?: boolean) => {\n        if (!this.flag) {\n            return;\n        }\n        const clients = getPositionEvent(e);\n\n        if (this.pinchFlag) {\n            this.onPinch(e, clients);\n        }\n        const result = this.move([0, 0], e, clients);\n\n        if (!result || (!result.deltaX && !result.deltaY)) {\n            return;\n        }\n        const drag = this.options.drag;\n\n        drag && drag({\n            ...result,\n            isScroll: !!isScroll,\n            inputEvent: e,\n        });\n    }\n    public move([deltaX, deltaY]: number[], inputEvent: any, clients = this.prevClients): OnDrag | undefined {\n        const customDist = this.customDist;\n        const prevClients = this.prevClients;\n        const startClients = this.startClients;\n        const position: Position = this.pinchFlag\n            ? getPinchDragPosition(clients, prevClients, startClients, this.startPinchClients)\n            : getPosition(clients[0], prevClients[0], startClients[0]);\n\n        customDist[0] += deltaX;\n        customDist[1] += deltaY;\n        position.deltaX += deltaX;\n        position.deltaY += deltaY;\n\n        const {\n            deltaX: positionDeltaX,\n            deltaY: positionDeltaY,\n        } = position;\n\n        position.distX += customDist[0];\n        position.distY += customDist[1];\n\n        this.movement += Math.sqrt(positionDeltaX * positionDeltaX + positionDeltaY * positionDeltaY);\n        this.prevClients = clients;\n        this.isDrag = true;\n\n        return {\n            type: \"drag\",\n            datas: this.datas,\n            ...position,\n            movement: this.movement,\n            isDrag: this.isDrag,\n            isPinch: this.isPinch,\n            isScroll: false,\n            inputEvent,\n        };\n    }\n    public onDragEnd = (e: any) => {\n        if (!this.flag) {\n            return;\n        }\n        const { dragend, pinchOutside, container } = this.options;\n        if (this.isTouch && pinchOutside) {\n            removeEvent(container!, \"touchstart\", this.onDragStart);\n        }\n        if (this.pinchFlag) {\n            this.onPinchEnd(e);\n        }\n        this.flag = false;\n\n        const prevClients = this.prevClients;\n        const startClients = this.startClients;\n\n        const position: Position = this.pinchFlag\n            ? getPinchDragPosition(prevClients, prevClients, startClients, this.startPinchClients)\n            : getPosition(prevClients[0], prevClients[0], startClients[0]);\n\n        const currentTime = now();\n        const isDouble = !this.isDrag && this.isDouble;\n\n        this.prevTime = this.isDrag || isDouble ? 0 : currentTime;\n        this.startClients = [];\n        this.prevClients = [];\n\n        dragend && dragend({\n            type: \"dragend\",\n            datas: this.datas,\n            isDouble,\n            isDrag: this.isDrag,\n            inputEvent: e,\n            ...position,\n        });\n    }\n    public onPinchStart(e: TouchEvent) {\n        const { pinchstart, pinchThreshold } = this.options;\n\n        if (this.isDrag && this.movement > pinchThreshold!) {\n            return;\n        }\n        const pinchClients = getClients(e.changedTouches);\n\n        this.pinchFlag = true;\n        this.startClients.push(...pinchClients);\n        this.prevClients.push(...pinchClients);\n        this.startDistance = getDist(this.prevClients);\n        this.startPinchClients = [...this.prevClients];\n\n        if (!pinchstart) {\n            return;\n        }\n        const startClients = this.prevClients;\n        const startAverageClient = getAverageClient(startClients);\n        const centerPosition = getPosition(\n            startAverageClient,\n            startAverageClient,\n            startAverageClient,\n        );\n\n        this.startRotate = getRotatiion(startClients);\n        pinchstart({\n            type: \"pinchstart\",\n            datas: this.datas,\n            angle: this.startRotate,\n            touches: getPositions(startClients, startClients, startClients),\n            ...centerPosition,\n            inputEvent: e,\n        });\n    }\n    public onPinch(e: TouchEvent, clients: Client[]) {\n        if (!this.flag || !this.pinchFlag || clients.length < 2) {\n            return;\n        }\n        this.isPinch = true;\n\n        const pinch = this.options.pinch;\n        if (!pinch) {\n            return;\n        }\n        const prevClients = this.prevClients;\n        const startClients = this.startClients;\n        const centerPosition = getPosition(\n            getAverageClient(clients),\n            getAverageClient(prevClients),\n            getAverageClient(startClients),\n        );\n        const angle = getRotatiion(clients);\n        const distance = getDist(clients);\n        pinch({\n            type: \"pinch\",\n            datas: this.datas,\n            movement: this.movement,\n            angle,\n            rotation: angle - this.startRotate,\n            touches: getPositions(clients, prevClients, startClients),\n            scale: distance / this.startDistance,\n            distance,\n            ...centerPosition,\n            inputEvent: e,\n        });\n    }\n    public onPinchEnd(e: TouchEvent) {\n        if (!this.flag || !this.pinchFlag) {\n            return;\n        }\n        const isPinch = this.isPinch;\n\n        this.isPinch = false;\n        this.pinchFlag = false;\n        const pinchend = this.options.pinchend;\n\n        if (!pinchend) {\n            return;\n        }\n        const prevClients = this.prevClients;\n        const startClients = this.startClients;\n        const centerPosition = getPosition(\n            getAverageClient(prevClients),\n            getAverageClient(prevClients),\n            getAverageClient(startClients),\n        );\n        pinchend({\n            type: \"pinchend\",\n            datas: this.datas,\n            isPinch,\n            touches: getPositions(prevClients, prevClients, startClients),\n            ...centerPosition,\n            inputEvent: e,\n        });\n        this.isPinch = false;\n        this.pinchFlag = false;\n    }\n    public triggerDragStart(e: any) {\n        this.onDragStart(e, false);\n    }\n    /**\n     *\n     */\n    public unset() {\n        const targets = this.targets;\n        const container = this.options.container!;\n\n        if (this.isMouse) {\n            targets.forEach(target => {\n                removeEvent(target, \"mousedown\", this.onDragStart);\n            });\n            removeEvent(container, \"mousemove\", this.onDrag);\n            removeEvent(container, \"mouseup\", this.onDragEnd);\n            removeEvent(container, \"contextmenu\", this.onDragEnd);\n        }\n        if (this.isTouch) {\n            targets.forEach(target => {\n                removeEvent(target, \"touchstart\", this.onDragStart);\n            });\n            removeEvent(container, \"touchstart\", this.onDragStart);\n            removeEvent(container, \"touchmove\", this.onDrag);\n            removeEvent(container, \"touchend\", this.onDragEnd);\n            removeEvent(container, \"touchcancel\", this.onDragEnd);\n        }\n    }\n    private initDrag() {\n        this.startClients = [];\n        this.prevClients = [];\n        this.flag = false;\n    }\n}\n\nexport default Dragger;\n","import Dragger from \"./Dragger\";\nimport { DragOptions } from \"./types\";\n\nexport default function setDrag(el: Element, options: DragOptions) {\n    return new Dragger(el, options);\n}\n","\nimport Dragger, * as modules from \"./index\";\n\nfor (const name in modules) {\n    (Dragger as any)[name] = (modules as any)[name];\n}\n\nexport default Dragger;\n"],"names":["getRad","pos1","pos2","distX","distY","rad","Math","atan2","PI","getRotatiion","touches","clientX","clientY","getPinchDragPosition","clients","prevClients","startClients","startPinchClients","nowCenter","getAverageClient","prevCenter","startCenter","pinchClient","plueClient","minusClient","pinchPrevClient","getPosition","isMultiTouch","e","length","getPositionEvent","getClients","getClient","client","prevClient","startClient","prevX","prevY","startX","startY","deltaX","deltaY","getDist","sqrt","pow","getPositions","map","i","min","push","client1","client2","INPUT_TAGNAMES","targets","options","isTrusted","_this","flag","cancelable","_a","container","pinchOutside","dragstart","preventRightClick","preventDefault","checkInput","isTouch","activeElement","document","target","tagName","toLowerCase","hasInput","indexOf","hasContentEditable","isContentEditable","contains","type","activeTagName","blur","timer","setTimeout","addEvent","onDragStart","passive","removeEvent","clearTimeout","changedTouches","pinchFlag","onPinchStart","customDist","isDrag","datas","movement","position","which","button","initDrag","result","inputEvent","isDouble","now","prevTime","isScroll","onPinch","move","drag","dragend","onPinchEnd","currentTime","elements","concat","window","pinchThreshold","events","isMouse","forEach","el","onDrag","onDragEnd","passive_1","isPinch","isCallDrag","positionDeltaX","positionDeltaY","_c","pinchstart","pinchClients","_b","startDistance","startAverageClient","centerPosition","startRotate","angle","pinch","distance","rotation","scale","pinchend","setDrag","Dragger","name","modules"],"mappings":"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"}